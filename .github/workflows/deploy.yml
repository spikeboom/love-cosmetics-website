# name: Deploy to Server
#
# Pipeline desativado - deploy manual
#
# on:
#   push:
#     branches:
#       - master # produção
#       - develop # desenvolvimento
#
# jobs:
#   deploy:
#     runs-on: ubuntu-latest
#
#     steps:
#       - name: Checkout code
#         uses: actions/checkout@v4
#
#       - name: Setup SSH
#         uses: webfactory/ssh-agent@v0.9.0
#         with:
#           ssh-private-key: ${{ secrets.SSH_PRIVATE_KEY }}
#
#       - name: Add server to known_hosts
#         run: ssh-keyscan -H 147.93.9.224 >> ~/.ssh/known_hosts
#
#       - name: Deploy code to server
#         env:
#           REF: ${{ github.ref }}
#         run: |
#           if [ "$REF" = "refs/heads/develop" ]; then
#             BRANCH="develop"
#           else
#             BRANCH="master"
#           fi
#
#           ssh root@147.93.9.224 "set -euo pipefail; \
#             cd /root/wordpress/next_project && \
#             git fetch origin && \
#             git reset --hard origin/$BRANCH"
#
#       - name: Start docker-compose
#         env:
#           REF: ${{ github.ref }}
#         run: |
#           if [ "$REF" = "refs/heads/master" ]; then
#             echo "Deploying to PRODUCTION with .env.master"
#             ssh root@147.93.9.224 "set -euo pipefail; \
#               cd /root/wordpress/next_project && \
#               echo 'Using .env.master' && \
#               docker-compose build --build-arg ENV_FILE=.env.master love-cosmetics && \
#               docker builder prune -f && \
#               docker-compose up -d love-cosmetics"
#           elif [ "$REF" = "refs/heads/develop" ]; then
#             echo "Deploying to DEVELOPMENT with .env.dev"
#             ssh root@147.93.9.224 "set -euo pipefail; \
#               cd /root/wordpress/next_project && \
#               echo 'Using .env.dev' && \
#               docker-compose build --build-arg ENV_FILE=.env.dev love-cosmetics-dev && \
#               docker builder prune -f && \
#               docker-compose up -d love-cosmetics-dev webserver"
#           else
#             echo "Deploying with .env (default)"
#             ssh root@147.93.9.224 "set -euo pipefail; \
#               cd /root/wordpress/next_project && \
#               echo 'Using .env' && \
#               docker-compose up -d --build love-cosmetics && \
#               docker builder prune -f"
#           fi
